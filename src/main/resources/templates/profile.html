<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>User Profile</title>
</head>
<body>
<!-- Header Fragment -->
<div th:replace="~{fragments :: header}"></div>

<h1 th:text="'Profile for ' + ${user.username}"></h1>

<!-- Only show form if not friends, not the user's own profile, and no pending request -->
<form th:if="${!isAlreadyFriends} and !${isSelfProfile} and !${hasPendingRequest}" action="/friend-requests/send" method="POST">
  <input type="hidden" name="receiverId" th:value="${user.id}" />
  <button type="submit">Send Friend Request</button>
</form>

<!-- Show message if a request is pending -->
<div th:if="${hasPendingRequest}">
  <p>Friend request sent.</p>

  <!-- Withdraw friend request button -->
  <form action="/friend-requests/withdraw" method="POST">
    <input type="hidden" name="receiverId" th:value="${user.id}" />
    <button type="submit">Cancel Request</button>
  </form>
</div>

<form th:if="${isAlreadyFriends} and !${isSelfProfile}" th:action="@{/friends/remove}" method="post" style="display:inline;">
  <input type="hidden" name="friendId" th:value="${user.id}" />
  <button type="submit">Remove Friend</button>
</form>

<p><strong>Email:</strong> <span th:text="${user.username}">Username</span></p>
<p><strong>Forename:</strong> <span id="forename" th:text="${user.forename}">Forename</span></p>
<p><strong>Surname:</strong> <span id="surname" th:text="${user.surname}">Surname</span></p>
<p><strong>Description:</strong> <span id="description" th:text="${user.description}">Description</span></p>
<p><strong>Gender:</strong> <span id="gender" th:text="${user.gender}">Gender</span></p>
<p><strong>Pronouns:</strong> <span id="pronouns" th:text="${user.pronouns}">Pronouns</span></p>
<p><strong>Current City:</strong> <span id="currentCity" th:text="${user.currentCity}">Current City</span></p>
<p><strong>Hometown:</strong> <span id="hometown" th:text="${user.hometown}">Hometown</span></p>
<p><strong>Job:</strong> <span id="job" th:text="${user.job}">Job</span></p>
<p><strong>School:</strong> <span id="school" th:text="${user.school}">School</span></p>
<p><strong>Relationship Status:</strong> <span id="relationshipStatus" th:text="${user.relationshipStatus}">Relationship Status</span></p>
<p><strong>Sexual Orientation:</strong> <span id="sexualOrientation" th:text="${user.sexualOrientation}">Sexual Orientation</span></p>
<p><strong>Political Views:</strong> <span id="politicalViews" th:text="${user.politicalViews}">Political Views</span></p>
<p><strong>Religion:</strong> <span id="religion" th:text="${user.religion}">Religion</span></p>

<!-- Footer Fragment -->
<div th:replace="~{fragments :: footer}"></div>
</body>
</html>
